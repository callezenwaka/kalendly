<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vanilla JS Calendar Example</title>
    <link rel="stylesheet" href="../../dist/styles/calendar.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .demo-controls {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .demo-controls h2 {
            margin-top: 0;
            color: #333;
        }
        
        .demo-controls button {
            background: #fc8917;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin-right: 10px;
            margin-bottom: 10px;
        }
        
        .demo-controls button:hover {
            background: #e67612;
        }
        
        .event-log {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            max-height: 200px;
            overflow-y: auto;
        }
        
        .event-log h3 {
            margin-top: 0;
            color: #333;
        }
        
        .log-entry {
            padding: 5px 0;
            border-bottom: 1px solid #eee;
            font-family: monospace;
            font-size: 12px;
        }
        
        .log-entry:last-child {
            border-bottom: none;
        }
    </style>
</head>
<body>
    <h1>kalendly Universal Calendar Scheduler - Vanilla JavaScript Demo</h1>
    
    <div class="demo-controls">
        <h2>Demo Controls</h2>
        <button id="addRandomBtn">Add Random Event</button>
        <button id="clearAllBtn">Clear All Events</button>
        <button id="goToTodayBtn">Go to Today</button>
        <button id="nextMonthBtn">Next Month</button>
        <button id="customEventBtn">Add Custom Event</button>
    </div>
    
    <!-- Calendar will be rendered here -->
    <div id="calendar"></div>
    
    <div class="event-log">
        <h3>Event Log</h3>
        <div id="log"></div>
    </div>

    <script type="module">
        // In a real project, you would import from 'kalendly/vanilla'
        import { createCalendar } from '../../dist/vanilla/index.mjs';
        
        // Sample events
        let events = [
            { 
                id: 1, 
                name: 'Team Meeting', 
                date: new Date(2025, 0, 15), // Jan 15, 2025
                description: 'Weekly team sync'
            },
            { 
                id: 2, 
                name: 'Project Deadline', 
                date: new Date(2025, 0, 20), // Jan 20, 2025
                description: 'Final submission due'
            },
            { 
                id: 3, 
                name: 'Birthday Party', 
                date: new Date(), // Today
                description: 'Office celebration'
            }
        ];
        
        // Custom event renderer
        const renderEvent = (event) => {
            return `
                <li class="event--item" style="cursor: pointer;" data-event-id="${event.id}">
                    <strong>${event.name}</strong>
                    ${event.description ? `<br><small>${event.description}</small>` : ''}
                </li>
            `;
        };
        
        // Create calendar instance
        const calendar = createCalendar({
            container: '#calendar',
            events: events,
            title: 'My Event Calendar',
            renderEvent: renderEvent,
            onDateSelect: (date) => {
                logEvent(`Date selected: ${date.toDateString()}`);
            }
        });
        
        // Event logging
        function logEvent(message) {
            const log = document.getElementById('log');
            const entry = document.createElement('div');
            entry.className = 'log-entry';
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            log.insertBefore(entry, log.firstChild);
            
            // Keep only last 20 entries
            while (log.children.length > 20) {
                log.removeChild(log.lastChild);
            }
        }
        
        // Listen to calendar events
        document.getElementById('calendar').addEventListener('dateSelect', (e) => {
            logEvent(`Date selected: ${e.detail.date.toDateString()}`);
        });
        
        document.getElementById('calendar').addEventListener('monthChange', (e) => {
            logEvent(`Month changed to: ${e.detail.year}-${e.detail.month + 1}`);
        });
        
        // Handle event item clicks
        document.getElementById('calendar').addEventListener('click', (e) => {
            const eventItem = e.target.closest('[data-event-id]');
            if (eventItem) {
                const eventId = eventItem.dataset.eventId;
                const event = events.find(evt => evt.id == eventId);
                if (event) {
                    logEvent(`Event clicked: ${event.name}`);
                }
            }
        });
        
        // Demo functions
        function addRandomEvent() {
            const eventNames = [
                'Code Review', 'Client Call', 'Lunch Meeting', 'Workshop', 
                'Conference', 'Training', 'Demo Day', 'Standup', 'Sprint Planning'
            ];
            
            const randomName = eventNames[Math.floor(Math.random() * eventNames.length)];
            const randomDate = new Date();
            randomDate.setDate(randomDate.getDate() + Math.floor(Math.random() * 30));
            
            const newEvent = {
                id: Date.now(),
                name: randomName,
                date: randomDate,
                description: 'Auto-generated event'
            };
            
            events.push(newEvent);
            calendar.updateEvents(events);
            logEvent(`Added event: ${newEvent.name} on ${randomDate.toDateString()}`);
        }
        
        function clearAllEvents() {
            events = [];
            calendar.updateEvents(events);
            logEvent('Cleared all events');
        }
        
        function goToToday() {
            calendar.goToDate(new Date());
            logEvent('Navigated to today');
        }
        
        function goToNextMonth() {
            const engine = calendar.getEngine();
            engine.getActions().next();
            logEvent('Navigated to next month');
        }
        
        function showCustomEvent() {
            const name = prompt('Event name:');
            if (name) {
                const dateStr = prompt('Date (YYYY-MM-DD):');
                if (dateStr) {
                    const date = new Date(dateStr);
                    if (!isNaN(date.getTime())) {
                        const newEvent = {
                            id: Date.now(),
                            name: name,
                            date: date,
                            description: 'Custom event'
                        };
                        
                        events.push(newEvent);
                        calendar.updateEvents(events);
                        logEvent(`Added custom event: ${name} on ${date.toDateString()}`);
                    } else {
                        alert('Invalid date format');
                    }
                }
            }
        }
        
        // Attach event listeners to buttons
        document.getElementById('addRandomBtn').addEventListener('click', addRandomEvent);
        document.getElementById('clearAllBtn').addEventListener('click', clearAllEvents);
        document.getElementById('goToTodayBtn').addEventListener('click', goToToday);
        document.getElementById('nextMonthBtn').addEventListener('click', goToNextMonth);
        document.getElementById('customEventBtn').addEventListener('click', showCustomEvent);
        
        // Initial log
        logEvent('Calendar initialized with vanilla JavaScript');
    </script>
</body>
</html>